## 获取注册中心中服务信息

> 联合办公，需要暴漏自己的服务信息，以及获取其他服务的信息；也叫服务注册与发现。

### 1. 依赖

```xml
<!--导入Eureka-->
  <dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-starter-eureka</artifactId>
    <version>1.4.6.RELEASE</version>
  </dependency>
</dependencies>
```

### 2. 获取方法

```java
package com.ths.provider.controller;

import org.springframework.cloud.client.ServiceInstance;
import org.springframework.cloud.client.discovery.DiscoveryClient;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

import java.util.List;

// 获取注册中心的微服务清单信息
@RestController
public class GetInstance {
  private final DiscoveryClient client;

  public GetInstance(DiscoveryClient client) {
    this.client = client;
  }

  @GetMapping("/discovery")
  public Object discovery() {
    // 获取微服务清单列表
    List<String> services = client.getServices();
    // 根据微服务id,获得某一个具体的微服务信息
    List<ServiceInstance> instances = client.getInstances("project-provider-8001-id");

    for (ServiceInstance instance : instances){
      System.out.println(instance.getHost());
      System.out.println(instance.getPort());
      System.out.println(instance.getUri());
      System.out.println(instance.getServiceId());
    }
    return this.client;
  }
}
```

### 3. 启动类

```java
package com.ths.provider;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.client.discovery.EnableDiscoveryClient;
import org.springframework.cloud.netflix.eureka.EnableEurekaClient;

@SpringBootApplication
// 启用Eureka客户端,自动将本服务注册到Eureka中
@EnableEurekaClient
// 服务发现(让其他的微服务发现自己,并得到自己的服务信息)
@EnableDiscoveryClient
public class Provider_8001 {
  public static void main(String[] args) {
    SpringApplication.run(Provider_8001.class, args);
  }
}
```
