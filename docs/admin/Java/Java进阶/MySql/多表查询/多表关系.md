## 多表关系

### 一对一

> 一个男人只能娶一个媳妇，一个女人也只能嫁给一个男人；一般不会有一对一，因为完全可以把两个表合二为一

### 一对多(多对一)

> 一个人可以有多个电脑，而一台电脑只能属于一个人
>
> 怎么做呢？
>
> 一般需要在多的一方添加一个字段，并添加外键关联，关联少的一方的主键

```sql
-- user表
create user(
  id int auto_increment primary key,
  u_name varchar(20)
);
-- computer表
create table computer(
  id int auto_increment primary key,
  c_name varchar(20),
  uid int,
  constraint c_u_key foreign key(uid) references user(id)
);

insert into user (u_name) values ('张三');
insert into computer (c_name, uid) values ('电脑1', 1);
insert into computer (c_name, uid) values ('电脑2', 1);
-- 新增的时候可以给个默认值，也可以不写；或者给null也不报错，但是给null就没有意义了
insert into computer (c_name) values ('电脑3');
insert into computer (c_name, uid) values ('电脑4', 1);

-- 删除外键约束
alter table computer drop foreign key c_u_key;
-- 添加外键约束
alter table computer add constraint c_u_key foreign key(uid) references user(id);
```

### 多对多关系

> 多个学生上多种课程
>
> 多个课程被多个学生选
>
> 学生表和课程表之间需要一个中间表，中间表中需要两个外键分别关联学生表和课程表

```sql
-- 学生表
create table student(
  id int auto_increment primary key,
  name varchar(20)
);
-- 课程表
create table course(
  id int auto_increment primary key,
  name varchar(20)
);
-- 中间表
create table student_course(
  sid int,
  cid int,
  primary key(sid, cid), -- 联合主键
  constraint stu_key foreign key(sid) references student(id),
  constraint cou_key foreign key(cid) references course(id)
);

-- 新增
insert into student (name) values ('张三');
insert into course (name) values ('语文');
insert into student_course (sid, cid) values (1, 1);
-- 删除
delete from student_course where sid = 1 and cid = 1;
```
