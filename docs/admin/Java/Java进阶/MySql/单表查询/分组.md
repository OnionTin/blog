## 分组

> select \* from 表名 group by 字段;
>
> 注意：
>
> 1. 分组之后查询的字段，必须是分组字段，或者是使用聚合函数处理的字段
>
> 2. where 和 having 都是条件语句；但 where 在分组前，而 having 在分组后

```sql
-- 按照性别分组，每组多少人
select count(*) from students group by sex;

-- 按照年龄分组，查询出每组的人数
-- 要求：只显示人数大于2的记录
-- 先分组，再筛选
select age, count(*) from students group by age having count(*) > 2;

-- 20岁以上的人，按照年龄分组，查询每组的人数
-- 要求：只显示人数大于2的记录
-- 先筛选，后分组，再筛选
select age, count(*) from students where age > 20 group by age having count(*) > 2;

-- 按照性别分组，查询出每组的人数
-- 要求：只显示人数大于2的记录，并且按照人数降序排序
-- 先分组，后筛选
select sex, count(*) from students group by sex
having count(*) > 2 order by count(*) desc;

-- 筛选出年龄大于18的记录，然后按照性别分组，查询出每组的人数，只展示人数大于2的记录
-- 要求：先筛选，后分组，再筛选
select sex, count(*) from students where age > 18 group by sex
having count(*) > 2;

-- 查询学生信息，按照年龄段分组查询，小于 18 的为一组，18-20 为一组，大于 20 的为一组
select age, count(*), case when age < 18 then '小于 18'
when age >= 18 and age <= 20 then '18-20'
else '大于 20' end as 年龄段 from students;
```
