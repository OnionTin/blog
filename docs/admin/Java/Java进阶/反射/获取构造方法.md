## 获取构造方法

### 如何获取构造方法的对象

获取<font color=red>public</font> 修饰的构造方法对象

| 方法                                                                         | 作用                               |
| ---------------------------------------------------------------------------- | ---------------------------------- |
| public Constructor&lt;T&gt; getConstructor(Class&lt;?&gt;... parameterTypes) | 获取单个 public 修饰的构造方法对象 |
| public Constructor&lt;T&gt;[] getConstructors()                              | 获取所有 public 修饰的构造方法对象 |

获取<font color=red>忽略修饰符</font>的构造方法对象

| 方法                                                                                 | 作用                 |
| ------------------------------------------------------------------------------------ | -------------------- |
| public Constructor&lt;T&gt; getDeclaredConstructor(Class&lt;?&gt;... parameterTypes) | 获取单个构造方法对象 |
| public Constructor&lt;T&gt;[] getDeclaredConstructors()                              | 获取所有构造方法对象 |

### 构造方法类对象中的方法

| 方法                                     | 作用                                                            |
| ---------------------------------------- | --------------------------------------------------------------- |
| public T newInstance(Object... initargs) | 创建一个类的实例                                                |
| public void setAccessible(boolean flag)  | 取消 java 语言的访问检查；暴力反射；(true：不校验，false：校验) |

```java
// public 修饰符的案例
package com.api.Reflex;

import java.lang.reflect.Constructor;

public class Demo03 {
    public static void main(String[] args) throws Exception {
        // 获取字节码文件对象
        Class clazz = Class.forName("com.api.Reflex.Student");

        // 1. public Constructor<T> getConstructor(Class<?>... parameterTypes)

        // 获取空参构造方法对象
        Constructor c1 = clazz.getConstructor();
        // 创建实例对象
        Object obj1 = c1.newInstance();
        // 创建实例对象并向下转型
        Student s1 = (Student) c1.newInstance();

        // 获取有一个String类型的参数的构造方法对象
        Constructor c2 = clazz.getConstructor(String.class);
        Object obj2 = c2.newInstance("Tom");
        Student s2 = (Student) c2.newInstance("Tom");

        // 获取有一个int类型的参数的构造方法对象
        Constructor c3 = clazz.getConstructor(int.class);
        Object obj3 = c3.newInstance(20);
        Student s3 = (Student) c3.newInstance(20);

        // 获取有2个参数的构造方法对象
        Constructor c4= clazz.getConstructor(String.class, int.class);
        Object obj4 = c4.newInstance("Tom", 20);
        Student s4 = (Student) c4.newInstance("Tom", 20);

        // 2. public Constructor<T>[] getDeclaredConstructors()
        // 获取所有的公共的构造方法对象(只有公共的，public)
        Constructor[] constructors = clazz.getConstructors();
        for (Constructor c: constructors) {
            System.out.println(c);
            // 结果：
            // public com.api.Reflex.Student(java.lang.String,int)
            // public com.api.Reflex.Student(int)
            // public com.api.Reflex.Student(java.lang.String)
            // public com.api.Reflex.Student()
        }
    }
}
class Student{
    private String name;
    private int age;

    public Student() {
    }

    public Student(String name) {
        this.name = name;
    }

    public Student(int age) {
        this.age = age;
    }

    public Student(String name, int age) {
        this.name = name;
        this.age = age;
    }
    @Override
    public String toString() {
        return "Student{" +
                "name='" + name + '\'' +
                ", age=" + age +
                '}';
    }
}
```

```java
// 忽略修饰符的案例(暴力反射)
package com.api.Reflex;

import java.lang.reflect.Constructor;

public class Demo04 {
    public static void main(String[] args) throws Exception {
        // 获取字节码文件对象
        Class clazz = Class.forName("com.api.Reflex.Teacher");

        // 1. public Constructor<T> getDeclaredConstructor(Class<?>... parameterTypes)

        // 获取空参构造方法对象
        Constructor c1 = clazz.getDeclaredConstructor();
        /*
         * setAccessible: true
         * 私有构造不能创建实例，加上setAccessible就可以了
         * 解除了java语言的访问权限检查
         * 暴力反射
         */
        c1.setAccessible(true);
        // 创建实例对象
        Object obj1 = c1.newInstance();
        // 创建实例对象并向下转型
        Teacher s1 = (Teacher) c1.newInstance();

        // 获取有一个String类型的参数的构造方法对象
        Constructor c2 = clazz.getDeclaredConstructor(String.class);
        Object obj2 = c2.newInstance("Tom");
        Teacher s2 = (Teacher) c2.newInstance("Tom");

        // 获取有一个int类型的参数的构造方法对象
        Constructor c3 = clazz.getDeclaredConstructor(int.class);
        Object obj3 = c3.newInstance(20);
        Teacher s3 = (Teacher) c3.newInstance(20);

        // 获取有2个参数的构造方法对象
        Constructor c4= clazz.getDeclaredConstructor(String.class, int.class);
        Object obj4 = c4.newInstance("Tom", 20);
        Teacher s4 = (Teacher) c4.newInstance("Tom", 20);

        // 2. public Constructor<T>[] getDeclaredConstructors()
        // 获取所有的构造方法对象(所有的，包括私有的等)
        Constructor[] constructors = clazz.getDeclaredConstructors();
        for (Constructor c: constructors) {
            System.out.println(c);
            // 结果：
            // public com.api.Reflex.Teacher(java.lang.String,int)
            // protected com.api.Reflex.Teacher(int)
            // com.api.Reflex.Teacher(java.lang.String)
            // private com.api.Reflex.Teacher()
        }
    }
}
class Teacher{
    private String name;
    private int age;

    private Teacher() {
    }

    Teacher(String name) {
        this.name = name;
    }

    protected Teacher(int age) {
        this.age = age;
    }

    public Teacher(String name, int age) {
        this.name = name;
        this.age = age;
    }
    @Override
    public String toString() {
        return "Teacher{" +
                "name='" + name + '\'' +
                ", age=" + age +
                '}';
    }
}
```
