## 获取成员方法对象

成员方法对象的访问权限相关的要求，与<RouteLink to="/admin/Java/Java进阶/反射/获取构造方法.md">构造方法对象</RouteLink>的访问权限相关的要求相同，都涉及到<font color=red>暴力反射</font>相关内容。

### 如何获取普通的成员方法的对象

获取<font color=red>public</font> 修饰的成员变量对象

| 方法                                                                   | 作用                                                              |
| ---------------------------------------------------------------------- | ----------------------------------------------------------------- |
| public Method getMethod(String name, Class&lt;?&gt;... parameterTypes) | 获取单个成员方法对象                                              |
| public Method[] getMethods()                                           | 获取<font color=red>所有的(哪怕是继承的)公共的</font>成员方法对象 |

获取<font color=red>忽略修饰符</font>的成员变量对象

| 方法                                                                           | 作用                                                |
| ------------------------------------------------------------------------------ | --------------------------------------------------- |
| public Method getDeclaredMethod(String name, Class&lt;?%gt;... parameterTypes) | 获取单个成员方法对象                                |
| public Method[] getDeclaredMethods()                                           | 获取<font color=red>本类中</font>的所有成员方法对象 |

### Method 类中的方法

| 方法                                             | 作用     |
| ------------------------------------------------ | -------- |
| public Object invoke(Object obj, Object... args) | 执行方法 |

```java
package com.api.Reflex;

import java.lang.reflect.Constructor;
import java.lang.reflect.Method;

public class Demo06 {
    public static void main(String[] args) throws Exception {
        // 字节码文件
        Class clazz = Class.forName("com.api.Reflex.Cat");
        // 构造方法对象
        Constructor c = clazz.getConstructor();
        // 创建实例对象
        Object o1 = c.newInstance();
        Object o2 = c.newInstance();

        // 获取公共的无参无返回值的方法对象
        Method m_aaa = clazz.getMethod("aaa");
        // 调用哪个实例对象的方法，以及传入的参数
        Object aaa_value = m_aaa.invoke(o1);
        System.out.println(aaa_value);
        // 结果：
        // 无参无返回值
        // null

        // 获取公共的有参无返回值的方法对象（需要传入参数的class类型）
        Method m_bbb = clazz.getMethod("bbb", String.class);
        // 调用哪个实例对象的方法，以及传入的参数
        Object bbb_value = m_bbb.invoke(o1, "bbb方法");
        System.out.println(bbb_value);
        // 结果：
        // bbb方法
        // null

        // 获取私有的的无参有返回值的方法对象
        Method m_ccc = clazz.getDeclaredMethod("ccc");
        // 设置暴力反射
        m_ccc.setAccessible(true);
        // 调用哪个实例对象的方法，以及传入的参数
        Object ccc_value = m_ccc.invoke(o2);
        System.out.println(ccc_value);
        // 结果：
        // 无参有返回值：10

        // 获取没有修饰符的有参有返回值的方法对象（需要传入参数的class类型）
        Method m_ddd = clazz.getDeclaredMethod("ddd", String.class, int.class);
        // 设置暴力反射
        m_ddd.setAccessible(true);
        // 调用哪个实例对象的方法，以及传入的参数
        Object ddd_value = m_ddd.invoke(o2, "我传了个：", 1000);
        System.out.println(ddd_value);
        // 结果：
        // 有参有返回值，我传了个：1000

        // 向下转型
        Method m_eee = clazz.getDeclaredMethod("eee", String.class);
        // 设置暴力反射
        m_eee.setAccessible(true);
        // 调用哪个实例对象的方法，以及传入的参数
        Integer eee_value = (Integer) m_eee.invoke(o2, "123");
        System.out.println(eee_value);
        // 结果：
        // 123

        // 获取所有的(哪怕是继承的也包含)公共的的成员方法
        Method[] methods1 = clazz.getMethods();
        for (Method method : methods1) {
            System.out.println(method);
            // 结果：
            // public java.lang.String com.api.Reflex.Cat.toString()
            // public static void com.api.Reflex.Cat.aaa()
            // public static void com.api.Reflex.Cat.bbb(java.lang.String)
            // public final void java.lang.Object.wait() ...
            // public final void java.lang.Object.wait(long,int) ...
            // public final native void java.lang.Object.wait(long) ...
            // public boolean java.lang.Object.equals(java.lang.Object)
            // public native int java.lang.Object.hashCode()
            // public final native java.lang.Class java.lang.Object.getClass()
            // public final native void java.lang.Object.notify()
            // public final native void java.lang.Object.notifyAll()
        }

        // 获取本类的所有的成员方法
        Method[] methods2 = clazz.getDeclaredMethods();
        for (Method method : methods2) {
            System.out.println(method);
            // 结果：
            // public java.lang.String com.api.Reflex.Cat.toString()
            // private int com.api.Reflex.Cat.ccc()
            // public static void com.api.Reflex.Cat.bbb(java.lang.String)
            // java.lang.String com.api.Reflex.Cat.ddd(int)
            // public static void com.api.Reflex.Cat.aaa()
        }
    }
}

class Cat {
    private String name;
    private int age;
    public String sex;

    public Cat() {
    }

    public Cat(String name, int age) {
        this.name = name;
        this.age = age;
    }

    @Override
    public String toString() {
        return "Cat{" +
                "name='" + name + '\'' +
                ", age=" + age +
                ", sex='" + sex + '\'' +
                '}';
    }

    // 无参无返回值
    public static void aaa() {
        System.out.println("无参无返回值");
    }

    // 有参无返回值
    public static void bbb(String message) {
        System.out.println(message);
    }

    // 无参有返回值
    private String ccc() {
        return "无参有返回值：" + 10;
    }

    // 有参有返回值
    String ddd(String s, int i) {
        return "有参有返回值，" + s + i;
    }

    // 向下转型
    protected int eee(String s) {
        return Integer.parseInt(s);
    }
}
```
