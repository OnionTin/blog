## 转发请求参数的方法

| 方法                                           | 作用                                                     |
| ---------------------------------------------- | -------------------------------------------------------- |
| Map &lt;String, String[]&gt; getParameterMap() | 获取所有参数的 name 和 value                             |
| String getParameter(String name)               | 获取指定 name 的项目的 value 值(input)                   |
| Enumeration &lt;String&gt; getParameterNames() | 获取所有参数的 name                                      |
| String[] getParameterValues(String name)       | 获取指定 name 的所有项目的 value 值(radio 或者 checkbox) |

```java
package com.Request;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;
import java.util.Enumeration;
import java.util.Map;
import java.util.Set;

@WebServlet("/ReqDemo02")
public class Demo02 extends HttpServlet {
  @Override
  protected void doGet(HttpServletRequest req, HttpServletResponse resp)
    throws ServletException, IOException {
    // String getParameter(String name)               获取指定名称的请求参数
    // Enumeration <String> getParameterNames() 获取所有请求参数的名称
    // String[] getParameterValues(String name)       获取指定名称的请求参数
    // Map <String, String[]> getParameterMap()  获取所有请求参数的名称和值

    // 设置编码格式，否则post请求会出现乱码问题
    req.setCharacterEncoding("utf-8");

    String username = req.getParameter("username");
    System.out.println(username);
    // 张三

    String password = req.getParameter("password");
    System.out.println(password);
    // 123456

    Enumeration<String> parameterNames = req.getParameterNames();
    while (parameterNames.hasMoreElements()) {
      String nextElement = parameterNames.nextElement();
      System.out.println(nextElement + ":" + req.getParameter(nextElement));
      // username:张三
      // password:123456
      // hobby:basketball
    }

    String[] hobbies = req.getParameterValues("hobby");
    for (String hobby : hobbies) {
      System.out.println(hobby);
      // basketball
      // pingpang
    }

    Map<String, String[]> map = req.getParameterMap();
    Set<Map.Entry<String, String[]>> set = map.entrySet();
    for (Map.Entry<String, String[]> entry : set) {
      String key = entry.getKey();
      String[] value = entry.getValue();
      for (String s : value) {
        System.out.println(key + ":" + s);
        // username:张三
        // password:123456
        // hobby:basketball
        // hobby:pingpang
      }
    }
  }

  @Override
  protected void doPost(HttpServletRequest req, HttpServletResponse resp)
    throws ServletException, IOException {
    this.doGet(req, resp);
  }
}
```

### 请求参数中文出现乱码问题

> 一般情况下，浏览器段都会在 html 种设置为 utf-8，而 tomcat 默认的编码为 ISO-8859-1，所以需要进行编码转换。
>
> 注意：乱码出现在 post 请求中，get 请求在 tomcat8 版本之后已经解决了，所以 get 请求不需要进行编码转换。

```java
// 获取请求参数
String username = request.getParameter("username");
// 进行编码转换
username = new String(username.getBytes("ISO-8859-1"), "UTF-8");
```

### BeanUtils 工具类的使用

| 方法                           | 作用                                       |
| ------------------------------ | ------------------------------------------ |
| BeanUtils.populate(user, map); | 把 表单项的 map 集合数据封装到 user 对象中 |

```java
package com.Request;

import com.domain.User;
import org.apache.commons.beanutils.BeanUtils;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;
import java.util.Map;

@WebServlet("/ReqDemo03")
public class Demo03 extends HttpServlet {
  @Override
  protected void doGet(HttpServletRequest req, HttpServletResponse resp)
    throws ServletException, IOException {
    req.setCharacterEncoding("utf-8");

    User user = new User();
    Map<String, String[]> map = req.getParameterMap();
    try {
      BeanUtils.populate(user, map);
    } catch (Exception e) {
      e.printStackTrace();
    }
    System.out.println(user);
  }

  @Override
  protected void doPost(HttpServletRequest req, HttpServletResponse resp)
    throws ServletException, IOException {
    this.doGet(req, resp);
  }
}
```

```java
// User.java
package com.domain;

public class User {
  private String username;
  private String password;
  private int sex;
  private int age;
  private String email;

  public String getUsername() {
    return username;
  }

  public void setUsername(String username) {
    this.username = username;
  }

  public String getPassword() {
    return password;
  }

  public void setPassword(String password) {
    this.password = password;
  }

  public int getSex() {
    return sex;
  }

  public void setSex(int sex) {
    this.sex = sex;
  }

  public int getAge() {
    return age;
  }

  public void setAge(int age) {
    this.age = age;
  }

  public String getEmail() {
    return email;
  }

  public void setEmail(String email) {
    this.email = email;
  }

  @Override
  public String toString() {
    return "User{" +
        "username='" + username + '\'' +
        ", password='" + password + '\'' +
        ", sex=" + sex +
        ", age=" + age +
        ", email='" + email + '\'' +
        '}';
  }
}
```

```html
<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<form method="post" action="http://localhost:8080/MyWebApp_war/ReqDemo03">
    姓名：<input type="text" name="username"/></br>
    密码：<input type="password" name="password"/></br>
    性别：<input type="radio" name="age" value="男" />
    <input type="radio" name="age" value="女" /></br>
    年龄：<input type="number" name="age"/></br>
    email:<input type="text" name="email"/></br>
    <input type="submit" value="提交"/>
</form>
</body>
</html>
```
