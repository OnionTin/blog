## 并发访问问题

### 多线程引发的安全问题(并发访问问题)

案例：

有一家电影院正在上映一部电影，一共只有 100 张票，有 3 个窗口在售票，请编写程序模拟售票过程。

```java
// 这段代码会出现安全问题
package com.api.DuoXianCheng;

public class Ticket01 {
    public static void main(String[] args) {
        // 三个窗口，即三个线程
        Ticket ticket = new Ticket();

        Thread t1 = new Thread(ticket);
        Thread t2 = new Thread(ticket);
        Thread t3 = new Thread(ticket);
        t1.setName("窗口1");
        t2.setName("窗口2");
        t3.setName("窗口3");

        t1.start();
        t2.start();
        t3.start();
    }
}
class Ticket implements Runnable {
    private int ticketNum = 100;
    @Override
    public void run() {
        // 售票代码
        while (true) {
            if (ticketNum > 0) {
                try {
                    Thread.sleep(1000);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                System.out.println(
                  Thread.currentThread().getName() + ":出票，票号为：" + ticketNum
                );
                ticketNum--;
            } else {
                break;
            }
        }
    }
}
```

### 问题分析：

1：多个线程出现重复的数据(比如多个线程都给出了票编号为 100)。

2：多个线程出现错误的数据(比如多个线程给出了票编号为 101 或-1)。

### 问题产生的原因：

多个线程在操作同一个数据时，没有同步机制，随着 CPU 的抢占，数据之间相互占用及修改，导致数据不一致。

### 解决问题的方法：

使用同步机制，保证同一时刻，只能有一个线程对数据进行操作。
