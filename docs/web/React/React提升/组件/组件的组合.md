<!-- @format -->

## 组件的组合

组件组合是 React 中的核心概念之一，它允许你将复杂的 UI 分解成独立可复用的组件。

### 1. 组合基础

在 React 中，组件可以嵌套组合，子组件可以接收来自父组件的 props。

```jsx
function Welcome(props) {
  return <h1>Hello, {props.name}</h1>;
}

function App() {
  return <Welcome name="Kimi" />;
}
```

### 2. Props 传递

父组件可以通过 props 向子组件传递数据。

```jsx
function Avatar(props) {
  return (
    <img
      src={props.user.avatarUrl}
      alt={props.user.name}
    />
  );
}

function UserInfo(props) {
  return (
    <div>
      <Avatar user={props.user} />
      <h2>{props.user.name}</h2>
    </div>
  );
}
```

### 3. 子组件组合

子组件可以进一步组合更小的组件。

```jsx
function Comment(props) {
  return (
    <div className="Comment">
      <Avatar user={props.author} />
      <div className="Comment-content">
        <div className="username">{props.author.name}</div>
        <div className="text">{props.text}</div>
      </div>
    </div>
  );
}
```

### 4. 条件渲染

组件可以根据条件渲染不同的子组件。

```jsx
function App() {
  const [isLoggedIn, setIsLoggedIn] = useState(false);

  function handleLoginClick() {
    setIsLoggedIn(true);
  }

  return (
    <div>
      {isLoggedIn ? <Dashboard /> : <Login />}
      <button onClick={handleLoginClick}>Log in</button>
    </div>
  );
}
```

### 5. 列表渲染

父组件可以使用 JavaScript 的`map`方法渲染子组件列表。

```jsx
function NumberList(props) {
  const numbers = props.numbers;
  return (
    <ul>
      {numbers.map((number) => (
        <ListItem
          key={number.id}
          value={number}
        />
      ))}
    </ul>
  );
}
```

### 6. Fragments

使用`React.Fragment`可以组合多个子组件而不添加额外的 DOM 元素。

```jsx
import React, { Fragment } from 'react';

function Dialog({ children, title }) {
  return (
    <Fragment>
      <h1>{title}</h1>
      <p>{children}</p>
    </Fragment>
  );
}
```

### 7. 高阶组件（HOC）

高阶组件是一个函数，它接受一个组件并返回一个新的组件。

```jsx
function withExtraInfo(WrappedComponent) {
  return class extends React.Component {
    render() {
      const extraInfo = someFunctionToCollectExtraInfo();
      return (
        <WrappedComponent
          {...this.props}
          extraInfo={extraInfo}
        />
      );
    }
  };
}
```

### 8. Context API

Context 允许你在组件树中传递值，而不必在每个层级手动传递 props。

```jsx
const MyContext = React.createContext(defaultValue);

function App() {
  return (
    <MyContext.Provider value={/* some value */}>
      <ChildComponent />
    </MyContext.Provider>
  );
}

function ChildComponent() {
  return (
    <MyContext.Consumer>
      {value => /* 渲染一些东西 */}
    </MyContext.Consumer>
  );
}
```

### 9. 组件的封装和复用

你应该构建可复用的组件，这样你可以在不同的项目中使用它们。

```jsx
function Button({ onClick, children }) {
  return <button onClick={onClick}>{children}</button>;
}

function App() {
  return <Button onClick={() => alert('Clicked!')}>Click me</Button>;
}
```

### 10. 组件的拆分

将大组件拆分为更小的子组件，可以提高代码的可维护性和可读性。

```jsx
// 大组件
function Post({ user, content }) {
  return (
    <article>
      <UserInfo user={user} />
      <Content content={content} />
    </article>
  );
}

// 小组件
function UserInfo({ user }) {
  // ...
}

function Content({ content }) {
  // ...
}
```

### 11. 组件之间的通信

组件之间可以通过 props、state 提升、Context 或状态管理库（如 Redux）进行通信。

### 12. 组件的性能优化

通过避免不必要的渲染和使用`React.memo`、`useMemo`、`useCallback`等进行性能优化。

组件组合是 React 中最重要的概念之一，它使得构建大型应用程序变得简单和可维护。通过合理地组合组件，你可以创建出既强大又灵活的用户界面。
