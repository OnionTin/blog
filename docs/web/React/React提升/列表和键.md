<!-- @format -->

## 列表和键

在 React 中，经常需要根据数组中的数据项渲染列表。正确地处理列表和键（Keys）对于性能优化和组件的正确行为至关重要。

### 1. 渲染列表

使用 JavaScript 的`map`函数在 JSX 中渲染数组中的每一项。

```jsx
function ItemList({ items }) {
  return (
    <ul>
      {items.map((item) => (
        <li key={item.id}>{item.text}</li>
      ))}
    </ul>
  );
}
```

### 2. 使用键（Keys）

为列表中的每个元素分配一个唯一的键（key），以帮助 React 识别哪些元素改变了、添加了或者被移除了。

### 3. 键的类型

键可以是数字、字符串或是元素在数组中的位置，但最佳实践是使用稳定的身份标识符。

```jsx
{
  items.map((item) => <li key={item.id}>{item.text}</li>);
}
```

### 4. 避免使用数组索引作为键

如果列表项可以重新排序，尽量避免使用数组索引作为键，因为这会导致性能问题和组件状态的错误。

### 5. 键的稳定性

键应该是稳定的、可预测的，且在组件的整个生命周期内不会变化。

### 6. 键的作用

键帮助 React 识别哪些元素是不同的，从而优化 DOM 操作和更新。

### 7. 没有键的后果

如果不提供键，React 会使用数组索引作为默认键，这可能会导致性能下降和组件状态不一致。

### 8. 在复杂数据结构中使用键

当渲染对象数组时，确保每个对象有一个唯一的键。

```jsx
{
  users.map((user) => (
    <User
      key={user.id}
      {...user}
    />
  ));
}
```

### 9. 列表的动态变化

当列表数据发生变化（添加、删除、排序）时，键能够帮助 React 正确地更新 DOM。

### 10. 使用`React.Fragment`优化列表

当渲染多个元素而不想添加额外的 DOM 元素时，可以使用`React.Fragment`。

```jsx
function ItemList({ items }) {
  return (
    <React.Fragment>
      {items.map((item) => (
        <li key={item.id}>{item.text}</li>
      ))}
    </React.Fragment>
  );
}
```

### 11. 使用`key`属性

在渲染数组元素时，通过`key`属性传递键。

```jsx
<li key={item.id}></li>
```

### 12. 避免在元素间共享键

每个元素的键应该是唯一的，不要在整个应用程序中共享键。

### 13. 键和性能

正确使用键可以提高渲染性能，尤其是在大规模列表渲染时。

### 14. 条件渲染列表

可以在`map`回调函数中进行条件渲染。

```jsx
{
  items
    .filter((item) => item.isVisible)
    .map((item) => <li key={item.id}>{item.text}</li>);
}
```

### 15. 使用`useMemo`优化列表

如果列表渲染涉及到高开销的操作，可以使用`useMemo`进行优化。

```jsx
const items = useMemo(() => computeExpensiveList(data), [data]);
```
