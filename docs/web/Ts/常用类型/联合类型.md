## 联合类型(|)

### 定义联合类型

```ts
type StringOrNumber = string | number;
```

### 使用联合类型

> 当你在函数中使用联合类型时，你可以传递任意一种指定的类型

```ts
function printId(id: StringOrNumber): void {
  console.log(`Your ID is: ${id}`);
}

printId(123); // 传递一个数字
printId("abc"); // 传递一个字符串
```

> 如果你有联合 string | number，则不能使用仅在 string 上可用的方法

```ts
function printId(id: number | string) {
  console.log(id.toUpperCase());
  // Property 'toUpperCase' does not exist on type 'string | number'.
  // Property 'toUpperCase' does not exist on type 'number'.
}

// 解决方案一
function printId(id: number | string) {
  if (typeof id === "string") {
    console.log(id.toUpperCase());
  } else {
    console.log(id);
  }
}

// 解决方案二
function welcomePeople(x: string[] | string) {
  if (Array.isArray(x)) {
    console.log("Hello, " + x.join(" and "));
  } else {
    console.log("Welcome lone traveler " + x);
  }
}
```

> 有时你会有一个联合，所有成员都有共同点。例如，数组和字符串都有一个 slice 方法。如果联合中的每个成员都有一个共同的属性，则可以使用该属性而不用缩小类型

```ts
function getFirstThree(x: number[] | string) {
  return x.slice(0, 3);
}
```

### 类型保护

> 在使用联合类型时，你可能需要确定变量的具体类型，以便执行特定类型的操作。TypeScript 提供了类型保护的概念，允许你在运行时检查并缩小类型

```ts
function printId(id: StringOrNumber): void {
  if (typeof id === "string") {
    // 在这个分支中，id 被缩小为 string 类型
    console.log(`Your string ID is: ${id.toUpperCase()}`);
  } else {
    // 在这个分支中，id 被缩小为 number 类型
    console.log(`Your numeric ID is: ${id}`);
  }
}
```

#### 例子

```ts
type UserResponse = string | { id: number };

function getUser(): UserResponse {
  // 这里只是示例，实际逻辑可能更复杂
  return Math.random() > 0.5 ? "Alice" : { id: 123 };
}

const user = getUser();
if (typeof user === "string") {
  console.log("User name:", user);
} else {
  console.log("User ID:", user.id);
}
```

### 联合类型和类型别名

> 联合类型经常与类型别名一起使用，以简化复杂类型的声明。例如，你可以为一个对象的多个可能形状创建一个联合类型

```ts
type User = {
  id: number;
  name: string;
  email?: string;
};

type Admin = {
  id: number;
  name: string;
  role: string;
};

type Person = User | Admin;

function printPersonDetails(person: Person): void {
  if ("role" in person) {
    console.log(`Admin ${person.name}, Role: ${person.role}`);
  } else {
    console.log(`User ${person.name}`);
  }
}
```
